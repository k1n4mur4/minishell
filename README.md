# Minishell

*As beautiful as a shell* - A bash-like shell implementation for 42 School

## 概要

Minishellは42 Schoolのプロジェクトとして実装されたシンプルなシェルです。bashの基本機能を再現し、プロセス管理、ファイルディスクリプタ、シグナル処理について深く学習できるように設計されています。

## 実装機能

### ✅ コア機能
- **プロンプト表示**: 新しいコマンド入力待ちの際にプロンプトを表示
- **履歴機能**: readlineライブラリを使用したコマンド履歴
- **実行ファイル検索**: PATH変数、相対パス、絶対パスでの実行ファイル探索
- **環境変数展開**: `$VAR` 形式の変数展開と `$?` による終了ステータス取得
- **SHLVL管理**: シェルのネストレベルを自動で更新・管理

### ✅ リダイレクション
- `<` : 標準入力のリダイレクト
- `>` : 標準出力のリダイレクト  
- `<<` : ヒアドキュメント（デリミタまで入力読み取り）
- `>>` : 追記モードでの出力リダイレクト

### ✅ パイプライン
- `|` : コマンド間のパイプ処理
- 複数コマンドのチェーン実行

### ✅ クォート処理
- **単一引用符** `'` : 内部の全メタ文字をリテラル処理
- **二重引用符** `"` : `$` 変数展開以外をリテラル処理

### ✅ シグナル処理
- **Ctrl-C**: 新しい行に新しいプロンプトを表示
- **Ctrl-D**: シェルを終了
- **Ctrl-\\**: 何もしない（SIGQUITを無視）

### ✅ ビルトインコマンド
- `echo` (オプション `-n` 対応)
- `cd` (相対パス・絶対パス対応)
- `pwd` (オプションなし)
- `export` (環境変数設定、オプションなし)
- `unset` (環境変数削除、オプションなし)
- `env` (環境変数一覧表示、オプション・引数なし)
- `exit` (シェル終了、オプションなし)

## ビルドと実行

### 必要環境
- macOS または Linux
- GNU Readline ライブラリ
- GCC コンパイラ

### ビルド方法
```bash
# プロジェクトのクローン
git clone <repository-url>
cd minishell

# ビルド
make

# 実行
./minishell
```

### Makeファイルターゲット
```bash
make        # ビルド
make clean  # オブジェクトファイル削除
make fclean # 全ファイル削除
make re     # 再ビルド
```

## プロジェクト構造

```
minishell/
├── Makefile                    # ビルドシステム
├── README.md                   # プロジェクト説明
├── minishell.md               # 仕様書
├── includes/                   # ヘッダファイル
│   ├── shell.h                # メインヘッダ
│   ├── builtins.h             # ビルトインコマンド
│   ├── lexer.h                # レキサ
│   ├── parser.h               # パーサ
│   ├── expander.h             # 変数展開
│   ├── executor.h             # 実行エンジン
│   ├── sig.h                  # シグナル処理
│   └── variables.h            # 変数管理
├── srcs/                      # ソースコード
│   ├── shell.c                # メイン処理
│   ├── builtins/              # ビルトインコマンド
│   │   ├── builtin_cd.c
│   │   ├── builtin_echo.c
│   │   ├── builtin_env.c
│   │   ├── builtin_exit.c
│   │   ├── builtin_export.c
│   │   ├── builtin_manager.c
│   │   ├── builtin_pwd.c
│   │   └── builtin_unset.c
│   ├── execute/               # 実行エンジン
│   │   ├── executor.c         # コマンド実行
│   │   ├── process.c          # プロセス管理
│   │   └── redirect.c         # リダイレクト処理
│   ├── parser/                # 構文解析
│   │   ├── lexer.c            # トークン化
│   │   ├── parser.c           # 構文解析
│   │   └── expander.c         # 変数展開
│   ├── signal.c               # シグナル処理
│   ├── variables.c            # 変数管理
│   └── utils/                 # ユーティリティ
│       └── memory.c           # メモリ管理
└── libft/                     # 42標準ライブラリ
```

## 技術仕様

### アーキテクチャ
1. **レキサ（Lexer）**: 入力文字列をトークンに分割
2. **パーサ（Parser）**: トークンをコマンド構造に解析
3. **エクスパンダ（Expander）**: 変数展開とクォート処理
4. **エグゼキュータ（Executor）**: コマンドの実行とプロセス管理

### メモリ管理
- 全動的メモリの適切な解放
- メモリリークの完全防止
- readline関数のリーク除外（仕様準拠）

### エラーハンドリング
- セグメンテーション違反やbus errorの防止
- 適切なエラーメッセージの表示
- 予期しない終了の回避

### 42 Norm準拠
- 関数の最大行数: 25行
- 適切な変数宣言と命名規則
- ヘッダファイルの保護とインクルード管理
- コードスタイルの統一

## 学習ポイント

このプロジェクトを通して以下を学習できます：

- **システムコール**: fork, exec, wait, pipe, dup2
- **プロセス管理**: 子プロセスの生成と制御
- **シグナル処理**: 適切なシグナルハンドリング
- **ファイルディスクリプタ**: 標準入出力の操作
- **メモリ管理**: 動的メモリの安全な使用
- **パーサ実装**: 文字列処理と構文解析
- **システムプログラミング**: UNIXシステムの理解

## 実装の特徴

- **安全なプロセス管理**: プロセスグループを使用した適切な制御
- **効率的なメモリ使用**: 必要最小限のメモリ確保
- **Bashとの互換性**: 主要機能でbashと同等の動作
- **エラー回復力**: 異常な入力に対する適切な処理
- **モジュラー設計**: 各機能の独立性と再利用性

---

*42 Tokyo の学習プロジェクト - 2025*
